
$(document).ready(function(){var c="https://db.softver.org.mk/influxdb/query";var h="status";var b={color:"#333",highlightColor:"#333",legend:{margin:[10,10],backgroundColor:"#fff",position:"nw"},shadowSize:0,grid:{borderColor:"#ddd",margin:{top:0,left:20,bottom:0,right:0}},lines:{show:true},points:{show:false},xaxis:{labelWidth:50,mode:"time",minTickSize:[15,"minute"]}};$("div[data-influx-query]").each(d);$(".btn-refresh").click(function(){var i=$(this).parent().parent().parent().children(".panel-body").children("div[data-influx-query]");i.each(d)});function d(){var i=$(this);var j=g(i);i.overlayLoader(j);j.then(function(){i.one("click",d)})}function g(k){var i=k.data("influx-url")||c;var n=k.data("influx-dbname")||h;var l=k.data("influx-query");var j=k.data("plot-options");var j=$.extend({},b,j);var m=a(i,n,l).then(function(p,o){var q=p.results[0].series[0];return e(q)}).then(function(o){k.plot(o,j)});return m}function a(i,k,j){return $.ajax({url:i,data:{db:k,q:j,epoch:"ms"}})}function e(l){var i=[];for(var j=1;j<l.columns.length;j++){i.push(f(l,j))}return i}function f(j,i){var k={};k.label=j.columns[i];k.data=j.values.map(function(l){return[l[0],l[i]]});return k}});(function(a){a.wait=function(b){return a.Deferred(function(c){setTimeout(c.resolve,b)}).promise()}}(jQuery));(function(a){a.fn.overlayLoader=function(b){return this.each(function(){var d=a(this);var c=a("<div class=loader/>");d.append(c);if(b&&b.then){b.then(function(){c.remove()},function(){c.remove()})}})}}(jQuery));